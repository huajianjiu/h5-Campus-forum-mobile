(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4a6fda72"],{"0d1a":function(t,e,i){"use strict";var n=i("8062"),s=i.n(n);s.a},8062:function(t,e,i){},a8b2:function(t,e,i){},e326:function(t,e,i){"use strict";var n=i("a8b2"),s=i.n(n);s.a},eb86:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("van-nav-bar",{attrs:{fixed:"",placeholder:"","left-arrow":""},on:{"click-left":t.onClickLeft},scopedSlots:t._u([{key:"right",fn:function(){return[i("van-popover",{directives:[{name:"show",rawName:"v-show",value:t.userInfo.uID==t.topicInfo.user.uID,expression:"userInfo.uID==topicInfo.user.uID"}],attrs:{trigger:"click",placement:"bottom-end",actions:t.actions},on:{select:t.toDeleteTopic},scopedSlots:t._u([{key:"reference",fn:function(){return[i("van-button",{staticClass:"iconfont",staticStyle:{border:"none",color:"#000","font-size":"25px"},attrs:{size:"normal"}},[t._v("")])]},proxy:!0}]),model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:"showPopover"}})]},proxy:!0}])}),i("div",{staticClass:"content"},[i("h1",{staticStyle:{"margin-top":"0","padding-top":"16px"}},[t._v(t._s(t.topicInfo.tTitle))]),i("div",{staticStyle:{overflow:"hidden"}},[i("span",{staticClass:"info"},[i("van-image",{attrs:{round:"","lazy-load":"",width:"40px",height:"40px",src:t.topicInfo.user.userAvatarUrl},on:{click:t.showBigImg}})],1),i("span",{staticClass:"info"},[i("div",{staticClass:"nickname"},[t._v(t._s(t.topicInfo.user.userNickname))]),i("div",{staticClass:"time"},[t._v(t._s(t.topicInfo.time))])])]),i("div",[i("p",{staticClass:"contents",staticStyle:{"font-size":"14px"}},[t._v(" "+t._s(t.topicInfo.tContents)+" ")]),t._l(t.imgList,(function(e,n){return i("van-image",{key:n,staticStyle:{"margin-top":"5px"},attrs:{radius:"5px","lazy-load":"",width:"100%",src:e},on:{click:function(e){return t.viewImage(n)}}})}))],2)]),i("div",{staticClass:"reply"},[i("div",{staticClass:"title"},[t._v("全部回复")]),i("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:function(e){return t.onLoad()}},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(t){return i("user-reply",{key:t.rID,attrs:{reply:t}})})),1)],1),i("div",{staticClass:"footer"},[i("div",{staticStyle:{display:"inline-block",width:"60%"}},[i("van-field",{staticClass:"rinput",attrs:{type:"text",maxlength:"50",placeholder:"发条友善的评论"},scopedSlots:t._u([{key:"left-icon",fn:function(){return[i("van-image",{attrs:{round:"",width:"25px",height:"25px",src:t.userInfo.userAvatarUrl}})]},proxy:!0}]),model:{value:t.message,callback:function(e){t.message=e},expression:"message"}})],1),i("van-icon",{class:{active:t.isActive,like:!0},attrs:{badge:t.topicInfo.tLike,name:"good-job"},on:{click:t.toLike}}),i("van-button",{staticStyle:{float:"right",width:"60px",margin:"1px 20px 0 0"},attrs:{round:"",color:"#7558fe",size:"small"},on:{click:t.sendReply}},[t._v("发送")])],1)],1)},s=[],o=(i("d81d"),i("498a"),i("d0ff")),r=(i("4662"),i("28a2")),a=(i("e7e5"),i("d399")),c=(i("e17f"),i("2241")),u=(i("96cf"),i("c964")),l=i("f3f3"),p=i("2f62"),f=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"replys"},[i("div",{staticClass:"upInfo"},[i("div",{staticClass:"imgs"},[i("van-image",{attrs:{round:"","lazy-load":"",width:"35px",height:"35px",src:t.reply.user.userAvatarUrl}})],1),i("div",{staticClass:"upUser"},[i("div",[t._v(t._s(t.reply.user.userNickname))]),i("div",[t._v(t._s(t.time))])]),i("div",{staticStyle:{float:"right",color:"#cccccc","font-size":"16px","padding-top":"5px"}},[i("van-icon",{class:{active:t.isActive},attrs:{name:"good-job"},on:{click:t.toLike}},[t._v(t._s(this.reply.rLikes))])],1)]),i("div",{staticClass:"bottomInfo"},[i("p",[t._v(t._s(t.reply.rContents))])])])},d=[],m=i("ed08"),v={name:"UserReply",data:function(){return{isActive:!1}},computed:{time:function(){return Object(m["a"])(this.reply.rTime)}},props:["reply"],methods:{toLike:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isActive?(t.reply.rLikes--,i=-1):(t.reply.rLikes++,i=1),t.isActive=!t.isActive,e.next=4,t.$API.home.reqLikeReply({rID:t.reply.rID,like:i});case 4:n=e.sent,200===n.code&&t.$toast.success("感谢点赞");case 6:case"end":return e.stop()}}),e)})))()}}},h=v,g=(i("e326"),i("2877")),I=Object(g["a"])(h,f,d,!1,null,"4646150b",null),k=I.exports,x={components:{UserReply:k},name:"TopicDetail",mounted:function(){this.topicInfo=this.$route.params,this.getImgList()},computed:Object(l["a"])({},Object(p["b"])(["userInfo"])),watch:{$route:{deep:!0,handler:function(t,e){this.topicInfo=this.$route.params,this.topicInfo.tID&&(this.getImgList(),this.page=1,this.list=[],this.onLoad())},immediate:!0}},data:function(){return{topicInfo:{},showPopover:!1,actions:[{text:"删除帖子",icon:"cross"}],message:"",isActive:!1,likes:10,imgList:[],list:[],loading:!1,finished:!1,page:1,limit:10,total:0}},methods:{getImgList:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$API.home.reqImgList({tID:t.topicInfo.tID});case 2:i=e.sent,200==i.code&&(n=i.data.map((function(t){return t.imgURL})),t.imgList=n);case 4:case"end":return e.stop()}}),e)})))()},toDeleteTopic:function(){var t=this;c["a"].confirm({message:"确认删除这条帖子吗？",confirmButtonColor:"#7558fe"}).then(Object(u["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$API.home.reqDeleteTopic({tID:t.topicInfo.tID});case 2:i=e.sent,200==i.code?(a["a"].success("删除成功"),t.$router.go(-1)):a["a"].fail("删除失败");case 4:case"end":return e.stop()}}),e)})))).catch((function(){}))},onClickLeft:function(){this.$router.go(-1)},toLike:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isActive?(t.topicInfo.tLike--,i=-1):(t.topicInfo.tLike++,i=1),t.isActive=!t.isActive,e.next=4,t.$API.home.reqLikeTopic({tID:t.topicInfo.tID,like:i});case 4:n=e.sent,200===n.code&&t.$toast.success("感谢点赞");case 6:case"end":return e.stop()}}),e)})))()},viewImage:function(t){Object(r["a"])({images:this.imgList,startPosition:t})},getList:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$API.home.reqReplyList({page:t.page,limit:t.limit,tID:t.topicInfo.tID});case 2:n=e.sent,t.refreshing=!1,0===n.data.length&&(t.list=[],t.finished=!0),t.total=n.data.count,(i=t.list).push.apply(i,Object(o["a"])(n.data.rows)),t.loading=!1,t.list.length>=n.data.count&&(t.finished=!0);case 9:case"end":return e.stop()}}),e)})))()},onLoad:function(){this.getList(),this.page++},sendReply:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.userInfo.uID){e.next=4;break}t.$dialog.confirm({confirmButtonText:"去登录",message:"必须先登录才能评论"}).then((function(){t.$router.push("/login")})).catch((function(){t.message=""})),e.next=10;break;case 4:if(""==t.message.trim()){e.next=10;break}return i={topicPID:t.topicInfo.tID,userUID:t.userInfo.uID,rContents:t.message},e.next=8,t.$API.home.reqSendReply(i);case 8:n=e.sent,200==n.code?(t.message="",t.page=1,t.list=[],t.onLoad(),t.$toast.success("评论成功")):t.$toast.fail("发送失败，请重试");case 10:case"end":return e.stop()}}),e)})))()},showBigImg:function(){Object(r["a"])({images:[this.topicInfo.user.userAvatarUrl],startPosition:0})}}},w=x,y=(i("0d1a"),Object(g["a"])(w,n,s,!1,null,"6557819e",null));e["default"]=y.exports}}]);